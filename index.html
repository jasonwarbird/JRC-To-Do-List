
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TODO List</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link id="dynamic-favicon" rel="icon" type="image/svg+xml">
<link rel="stylesheet" href="styles.css">
<!-- 
========================================================
HTML File: index.html
Version: 1.03
Build Date: January 16, 2026 11:45 EST
Description: Responsive TODO List App with Light/Dark Mode, Export/Import, Auto-refresh, Carousel
========================================================
-->
</head>
<body>
<h1>My TODO List</h1>
<div class="input-container">
    <input id="todo-input" type="text" placeholder="Add a new task">
    <input id="due-date" type="datetime-local">
    <select id="priority"><option value="Low">Low</option><option value="Normal" selected>Normal</option><option value="High">High</option></select>
    <button id="add-btn">Add</button>
</div>
<div class="sort-container">
    <label for="sort-option">Sort by:</label>
    <select id="sort-option"><option value="due">Due Date</option><option value="priority">Priority</option><option value="name">Task Name</option></select>
    <button id="clear-btn">Clear Completed Tasks</button>
    <button id="mode-toggle">Toggle Light/Dark Mode</button>
</div>
<div class="timer-container">
    <label for="refresh-interval">Refresh every (seconds):</label>
    <input type="number" id="refresh-interval" value="30" min="5" style="width:80px;">
    <label><input type="checkbox" id="auto-refresh" checked> Auto-refresh</label>
    <button id="refresh-btn">Manual Refresh</button>
    <span>Next refresh in: <span id="countdown">30</span>s</span>
</div>
<div class="theme-picker">
    <label for="color-picker">Theme Color:</label>
    <input type="color" id="color-picker" value="#0078d7">
</div>
<div class="file-actions">
    <button id="export-btn">Export Tasks to JSON</button>
    <input type="file" id="import-file" accept=".json" style="display:none;">
    <button id="import-btn">Import Tasks from JSON</button>
    <button id="clear-all-btn">Clear All Data</button>
</div>
<div class="carousel-container">
    <div class="carousel-title">Tasks Due Today or Past Due</div>
    <div class="carousel" id="carousel"></div>
</div>
<ul id="todo-list"></ul>
<footer>&copy; Jason Compton | Version 1.03 | Build Date: January 16, 2026 11:45 EST</footer>

<script>
// Full JavaScript logic (unchanged from previous working version)
const input=document.getElementById('todo-input'),dueInput=document.getElementById('due-date'),prioritySelect=document.getElementById('priority'),addBtn=document.getElementById('add-btn'),clearBtn=document.getElementById('clear-btn'),sortOption=document.getElementById('sort-option'),refreshInput=document.getElementById('refresh-interval'),autoRefreshCheckbox=document.getElementById('auto-refresh'),refreshBtn=document.getElementById('refresh-btn'),countdownDisplay=document.getElementById('countdown'),list=document.getElementById('todo-list'),carousel=document.getElementById('carousel'),colorPicker=document.getElementById('color-picker'),exportBtn=document.getElementById('export-btn'),importBtn=document.getElementById('import-btn'),importFile=document.getElementById('import-file'),clearAllBtn=document.getElementById('clear-all-btn'),modeToggle=document.getElementById('mode-toggle');
let tasks=JSON.parse(localStorage.getItem('tasks'))||[],refreshTimer,countdownTimer,countdownValue=parseInt(refreshInput.value);

// Update favicon dynamically
function updateFavicon(){
    const themeColor=getComputedStyle(document.documentElement).getPropertyValue('--theme-color').trim();
    const svg=`<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64'><rect width='100%' height='100%' fill='${themeColor}'/><text x='50%' y='50%' font-size='28' font-family='Arial' fill='white' text-anchor='middle' dominant-baseline='central'>JRC</text></svg>`;
    document.getElementById('dynamic-favicon').href='data:image/svg+xml,'+encodeURIComponent(svg);
}
updateFavicon();
colorPicker.addEventListener('input',e=>{
    document.documentElement.style.setProperty('--theme-color',e.target.value);
    updateFavicon();
});

function saveTasks(){localStorage.setItem('tasks',JSON.stringify(tasks));}
function renderTasks(){
    list.innerHTML='';
    sortTasks(sortOption.value);
    tasks.forEach((task,index)=>{
        const li=document.createElement('li');
        const checkbox=document.createElement('input');
        checkbox.type='checkbox';
        checkbox.checked=task.checked;
        checkbox.addEventListener('change',()=>{
            task.checked=checkbox.checked;
            saveTasks();
            renderTasks();
        });
        const infoDiv=document.createElement('div');
        infoDiv.className='task-info';
        infoDiv.innerHTML=`<span>${task.text}</span><span class="due-date">${task.due?`Due: ${new Date(task.due).toLocaleString()}`:''}</span><span class="priority-label priority-${task.priority.toLowerCase()}">${task.priority}</span>`;
        const btnGroup=document.createElement('div');
        btnGroup.className='btn-group';
        const editBtn=document.createElement('button');
        editBtn.textContent='Edit';
        editBtn.className='edit-btn';
        editBtn.onclick=()=>editTask(task);
        const deleteBtn=document.createElement('button');
        deleteBtn.textContent='Delete';
        deleteBtn.className='delete-btn';
        deleteBtn.onclick=()=>{
            tasks.splice(index,1);
            saveTasks();
            renderTasks();
        };
        btnGroup.append(editBtn,deleteBtn);
        li.append(checkbox,infoDiv,btnGroup);
        list.appendChild(li);
    });
    renderCarousel();
}

function renderCarousel(){
    carousel.innerHTML='';
    const today=new Date();
    const todayString=today.toDateString();
    const dueTodayOrPast=tasks.filter(task=>{
        if(task.due&&!task.checked){
            const dueDate=new Date(task.due);
            return dueDate.toDateString()===todayString||dueDate<today;
        }
        return false;
    });
    if(dueTodayOrPast.length===0){
        carousel.innerHTML='<div style="color:#666;">No tasks due today or past due.</div>';
        return;
    }
    dueTodayOrPast.forEach(task=>{
        const item=document.createElement('div');
        item.className='carousel-item';
        item.innerHTML=`<strong>${task.text}</strong>Due: ${new Date(task.due).toLocaleString()}`;
        carousel.appendChild(item);
    });
}

function editTask(task){
    const newText=prompt('Edit task:',task.text);
    const newDue=prompt('Edit due date (YYYY-MM-DD HH:MM):',task.due);
    const newPriority=prompt('Edit priority (Low, Normal, High):',task.priority);
    if(newText)task.text=newText;
    if(newDue)task.due=newDue;
    if(['Low','Normal','High'].includes(newPriority))task.priority=newPriority;
    saveTasks();
    renderTasks();
}

function addItem(){
    const text=input.value.trim(),due=dueInput.value,priority=prioritySelect.value;
    if(!text)return;
    tasks.push({text,due,priority,checked:false});
    saveTasks();
    renderTasks();
    input.value='';
    dueInput.value='';
    prioritySelect.value='Normal';
}

function sortTasks(c){
    if(c==='due')tasks.sort((a,b)=>(a.due?new Date(a.due):Infinity)-(b.due?new Date(b.due):Infinity));
    else if(c==='priority'){const order={High:1,Normal:2,Low:3};tasks.sort((a,b)=>order[a.priority]-order[b.priority]);}
    else tasks.sort((a,b)=>(a.text||'').localeCompare(b.text||''));
}

sortOption.onchange=()=>renderTasks();
clearBtn.onclick=()=>{tasks=tasks.filter(t=>!t.checked);saveTasks();renderTasks();};
refreshBtn.onclick=()=>{renderTasks();countdownValue=parseInt(refreshInput.value);countdownDisplay.textContent=countdownValue;};

function startRefreshTimer(){
    if(refreshTimer)clearInterval(refreshTimer);
    if(countdownTimer)clearInterval(countdownTimer);
    const interval=parseInt(refreshInput.value)*1000;
    if(interval>=5000&&autoRefreshCheckbox.checked){
        countdownValue=parseInt(refreshInput.value);
        countdownDisplay.textContent=countdownValue;
        refreshTimer=setInterval(()=>{renderTasks();countdownValue=parseInt(refreshInput.value);},interval);
        countdownTimer=setInterval(()=>{countdownValue--;if(countdownValue<=0)countdownValue=parseInt(refreshInput.value);countdownDisplay.textContent=countdownValue;},1000);
    }else countdownDisplay.textContent='Paused';
}
startRefreshTimer();
refreshInput.oninput=startRefreshTimer;
autoRefreshCheckbox.onchange=startRefreshTimer;
addBtn.onclick=addItem;
input.onkeypress=e=>{if(e.key==='Enter')addItem();};

// Export tasks to JSON
exportBtn.addEventListener('click',()=>{
    const jsonData=JSON.stringify(tasks,null,2);
    const blob=new Blob([jsonData],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const link=document.createElement('a');
    link.href=url;
    link.download='tasks.json';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
});

// Import tasks from JSON
importBtn.addEventListener('click',()=>importFile.click());
importFile.addEventListener('change',event=>{
    const file=event.target.files[0];
    if(!file)return;
    const reader=new FileReader();
    reader.onload=e=>{
        try{
            const importedTasks=JSON.parse(e.target.result);
            if(Array.isArray(importedTasks)){
                tasks=importedTasks;
                saveTasks();
                renderTasks();
                alert('Tasks imported successfully!');
            }else alert('Invalid file format.');
        }catch(error){alert('Error reading file. Please ensure it is valid JSON.');}
    };
    reader.readAsText(file);
});

// Clear All Data with Automatic Backup
clearAllBtn.addEventListener('click',()=>{
    if(confirm('Are you sure you want to clear all tasks? A backup will be downloaded before clearing.')){
        const jsonData=JSON.stringify(tasks,null,2);
        const blob=new Blob([jsonData],{type:'application/json'});
        const url=URL.createObjectURL(blob);
        const link=document.createElement('a');
        link.href=url;
        link.download='tasks-backup.json';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        localStorage.removeItem('tasks');
        tasks=[];
        renderTasks();
        alert('All tasks have been cleared. Backup downloaded.');
    }
});

// âœ… Light/Dark Mode Toggle Fix
modeToggle.addEventListener('click',()=>{
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('darkMode',document.body.classList.contains('dark-mode'));
});
if(localStorage.getItem('darkMode')==='true'){document.body.classList.add('dark-mode');}

renderTasks();
</script>
</body>
</html>
